package fr.esisar.controller;
import fr.esisar.model.*;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import javax.management.Query;

import fr.esisar.controller.*;
public class FichierImageDAO extends FichierImage {
	
	public FichierImageDAO(String cheminAcces, String appareilPhoto, String objectif, double distanceFocal,
			String sensibiliteISO, String ouverture, double vitesseOburation, Client client) {
		
		super(cheminAcces,appareilPhoto,objectif,distanceFocal,sensibiliteISO,ouverture,vitesseOburation,client);
	}
	
	public FichierImageDAO()  {
		super();
	}
	
//	public void verifyPhotoInAlbum() {//aucune contient
//		if (true) {//if photo not in any album
//			//not clear photo class missing
//			String url = null;
//			SupprimerFichierImage(connect, url, adressMail);
//		}
//	}
	public static boolean InsererFichierImage(Connection Connection, String cheminAcces, String appareilPhoto,
			String objectif, String distanceFocal, String sensibiliteISO, String ouverture, String vitesseOburation,
			String adressMail) {
		Statement statement;
		ResultSet result = null;
		try {
			statement = Connection.createStatement();
			String quer1 = "INSERT INTO FichierImage (cheminAcces, appareilPhoto, objectif, distanceFocale, sensibiliteISO, ouverture, vitesseObturation,adresseMail) ";
			String quer2 = "VALUES ('" + cheminAcces + "', '" + appareilPhoto + "', '" + objectif + "', '" + distanceFocal + "', '"
					+ sensibiliteISO + "', '" + ouverture + "', '" + vitesseOburation +  "', '" + adressMail+"')";
			statement.executeUpdate(quer1 + quer2);
			System.out.println("fichier Image est bien ajout√©!");
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		
		return false;
	}
         //j'ai pas besion d email ici ! pourquoiboolean ?
	public static boolean SupprimerFichierImage(Connection connect, String url) throws ClassNotFoundException {
		Statement statement;
		ResultSet result = null;
		try {//supprimer contient tout d'abord!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
			statement = connect.createStatement();
			String sql = "DELETE FROM FichirImage WHERE cheminAcces = '" + url + "'";
			;
			statement.executeUpdate(sql);
			return true;

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			return false;
		}
		
	}
	
	public FichierImage findByURL(Connection connect,String url) throws SQLException {
		Statement statement;
		ResultSet result = null;
	
	
			statement = connect.createStatement();
			String sql = "SELECT * FROM FichirImage WHERE cheminAcces = \'" + url + "\' ";
			;
			result = statement.executeQuery(sql);
			FichierImage image=new FichierImage();
			while (result.next()) {
				image.setAppareilPhoto(result.getString("appareilPhoto"));
				image.setObjectif(result.getString("objectif"));
				image.setDistanceFocal(Double.parseDouble(result.getString("distanceFocal")));
				image.setSensibiliteISO(result.getString("sensibiliteISO"));
				
				image.setOuverture(result.getString("ouverture"));
				image.setVitesseOburation(Double.parseDouble(result.getString("VitesseOburation")));  
			}
			return image;
		
		

	}

	
	
}
